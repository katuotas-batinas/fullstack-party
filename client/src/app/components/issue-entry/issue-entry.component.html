<app-header></app-header>
<div class="page-container">
    <div class="content">
        <div class="container">
            <div class="row">
                <div class="column issue-header">
                    <a routerLink="/issues" class="primary"><fa name="chevron-left"></fa> Back to Issues</a>
                </div>
            </div>

            <div class="row" *ngIf="error">
                <div class="column">
                    <p>{{ error }}</p>
                </div>
            </div>

            <div class="row" *ngIf="isLoading">
                <div class="column">
                    <p>Fetching issue...</p>
                </div>
            </div>

            <div class="row" *ngIf="issue">
                <div class="column issue-content">
                    <div class="box">
                        <div class="box-body">
                            <h3 class="issue-title">{{ issue.title }} <span class="faded">#{{ issue.number }}</span></h3>
                            <div class="issue-body">
                                <markdown [data]="issue.body"></markdown>
                            </div>
                            <div class="issue-details">
                                <span *ngIf="issue.state === 'open'" class="badge open-bg status-badge"><fa name="exclamation-circle"></fa> Open</span>
                                <span *ngIf="issue.state === 'closed'" class="badge closed-bg status-badge"><fa name="check-circle"></fa> Closed</span>
                                <p class="issue-meta faded" *ngIf="issue.state === 'open'">
                                    <a [href]="issue.user.html_url" target="_blank" class="primary">{{ issue.user.login }}</a> opened this issue {{ issue.created_at | timeSince }} ago &#183; {{ issue.comments }} comments
                                </p>
                                <p class="issue-meta faded" *ngIf="issue.state === 'closed'">
                                    <a [href]="issue.user.html_url" target="_blank" class="primary">{{ issue.user.login }}</a> closed this issue {{ issue.closed_at | timeSince }} ago &#183; {{ issue.comments }} comments
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row" *ngIf="issue && issue.comments_entries">
                <div class="column comment-list">
                    <div class="comment-container" *ngFor="let comment of issue.comments_entries">
                        <div class="comment-avatar">
                            <img [src]="comment.user.avatar_url" class="image-circle avatar"/>
                        </div>
                        <div class="comment-body">
                            <div class="box bubble">
                                <div class="box-header faded">
                                    <a [href]="comment.user.html_url" target="_blank" class="primary">{{ comment.user.login }}</a> commented {{ comment.created_at | timeSince }} ago
                                </div>
                                <div class="box-body">
                                    <markdown [data]="comment.body"></markdown>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
